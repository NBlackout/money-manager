@using global::App.Read.Ports
<div class="table-responsive">
    <table class="align-middle table table-hover table-sm table-borderless">
        <tbody>
        @foreach (IGrouping<DateOnly, TransactionSummaryPresentation> transactionsPerDate in Transactions.GroupBy(t => t.Date))
        {
            @foreach ((TransactionSummaryPresentation transaction, int index) in transactionsPerDate.Select((p, i) => (p, i)))
            {
                <tr @onclick="@(() => OpenCategoryPickerFor(transaction.Id))" role="button">
                    <td>@(index == 0 ? transaction.Date.ToString("dd/MM") : string.Empty) </td>
                    <td class="text-end">
                        <span class="text-@(transaction.Amount > 0 ? "success" : "danger")">@transaction.Amount.ToString("N2") â‚¬</span>
                    </td>
                    <td class="lh-sm w-100">
                        @if (isEditing && transactionId!.Value == transaction.Id)
                        {
                            <input type="text" value="@transaction.Label" @ref="labelElement" @onchange="LabelChanged" @onfocusout="ExitEditMode" @onclick:stopPropagation="true"
                                   class="form-control form-control-sm" placeholder="Label"/>
                        }
                        else
                        {
                            <span @onclick="@(() => EnterEditMode(transaction.Id))" @onclick:stopPropagation="true" class="transaction-label">@transaction.Label</span>
                            <div class="small text-secondary">@transaction.Category</div>
                        }
                    </td>
                </tr>
            }
        }
        </tbody>
    </table>
</div>