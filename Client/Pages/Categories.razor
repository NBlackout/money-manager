@page "/categories"
@page "/categories/create"
@using Client.Components
@using global::App.Read.Ports

<div class="row justify-content-between">
    <div class="col-4">
        @if (isCreating)
        {
            <EditForm Model="Category" OnSubmit="Create" FormName="CreateCategory">
                <InputText @bind-Value="Category!.Label" @ref="labelElement" @onfocusout="ExitCreateMode" class="form-control"></InputText>
            </EditForm>
        }
        else
        {
            <button class="btn btn-primary" @onclick="EnterCreateMode">
                <small class="bi bi-plus-lg"></small>
                Create
            </button>
        }
    </div>
    <div class="col-4 text-end">
        <div class="btn-group">
            <label class="btn btn-primary">
                <small class="bi bi-upload"></small>
                Import
                <InputFile OnChange="ImportCategoriesFile" accept=".csv" class="btn btn-primary d-none"></InputFile>
            </label>
            <button class="btn btn-primary" @onclick="ExportCategories" disabled="@(categories is { Length: 0 })">
                <small class="bi bi-download"></small>
                Export
            </button>
        </div>
        @if (uploadResult != null)
        {
            <div>@uploadResult</div>
        }
    </div>
</div>

@if (categories is { Length: > 0 })
{
    <div class="row row-cols-4 g-4">
        @foreach (CategorySummaryPresentation category in categories)
        {
            <CategoryCard Category="category" OnCategoryDeleted="OnCategoryDeleted"></CategoryCard>
        }
    </div>
}